MASTER FINAL FIX PROMPT â€” UI + API + VEHICLE LUGGAGE LOGIC + BOOKINGS SYNC

Our database is 100% correct and fully populated:

âœ… 15 customers

âœ… 2 vendors

âœ… 16 drivers

âœ… 16 vehicles

âœ… 116 bookings

âœ… neondb connected properly via DATABASE_URL

âœ… All APIs connected to the same DB

The only problem is that the APIs and frontend are still using OLD column names and OLD relational assumptions.
This is why the UI shows blank even though the DB has data.

Please implement ALL fixes below in ONE go.

âœ… 1ï¸âƒ£ FIX ALL BOOKING APIS TO MATCH REAL bookings TABLE
âœ… REAL columns that MUST be used:

id

customer_name

customer_phone

customer_email

pickup_location

dropoff_location

distance_km

fare_aed

vehicle_type

booking_type

status

payment_method

passengers_count

luggage_count

created_at

assigned_vehicle_id

vendor_id

driver_id

âŒ STOP using these (THEY DO NOT EXIST):

customer_id

fare

vehicle_id

price

payment_mode

âœ… 2ï¸âƒ£ FIX BOOKINGS LIST API QUERY (NO CUSTOMER JOIN)

Use direct bookings data only:

SELECT 
  id,
  customer_name,
  customer_phone,
  pickup_location,
  dropoff_location,
  fare_aed,
  status,
  payment_method,
  passengers_count,
  luggage_count,
  created_at,
  assigned_vehicle_id,
  vendor_id,
  driver_id
FROM bookings
ORDER BY created_at DESC
LIMIT 50;


Frontend must display:

customer_name

customer_phone

fare_aed

status

payment_method

passengers_count

luggage_count

âœ… 3ï¸âƒ£ FIX VEHICLE & DRIVER JOINS
âœ… Vehicle Join:
LEFT JOIN vehicles v 
ON v.id = b.assigned_vehicle_id

âœ… Driver Join:
LEFT JOIN drivers d 
ON d.id = b.driver_id


âŒ Do NOT use vehicle_id anymore.

âœ… 4ï¸âƒ£ FIX DASHBOARD STATS QUERIES

All dashboard stats must come ONLY from bookings and vehicles:

SELECT COUNT(*) FROM bookings;
SELECT COUNT(*) FROM bookings WHERE status = 'completed';
SELECT COUNT(*) FROM bookings WHERE status = 'pending';
SELECT COUNT(*) FROM bookings WHERE status = 'cancelled';
SELECT SUM(fare_aed) FROM bookings WHERE status = 'completed';

SELECT COUNT(*) FROM vehicles WHERE active = true;
SELECT COUNT(*) FROM drivers WHERE status = 'online';


Dashboard MUST show:

Total bookings

Completed

Pending

Cancelled

Total revenue

Active vehicles

Online drivers

âœ… 5ï¸âƒ£ FIX API RESPONSE FORMAT (FRONTEND BREAKING BUG)

ALL APIs must return in this exact format:

{
  "success": true,
  "data": [...]
}


Frontend must always read:

response.data.data


Fix especially:

/api/bookings

/api/customers

/api/drivers

/api/vehicles

/api/dashboard/stats

âœ… 6ï¸âƒ£ VEHICLE LUGGAGE + PASSENGER CAPACITY LOGIC (MANDATORY)

Your DB already has:

vehicles.max_passengers âœ…

vehicles.max_luggage âœ…

bookings.passengers_count âœ…

bookings.luggage_count âœ…

Now implement SMART AUTO FILTERING:

WHERE v.max_passengers >= b.passengers_count
AND v.max_luggage >= b.luggage_count
AND v.active = true
AND v.status = 'available'


If no exact match:
â¡ Auto-suggest next higher vehicle type
â¡ Else return:

"No vehicle available for given passenger & luggage requirement"

âœ… 7ï¸âƒ£ OPERATOR + AI BOOKING FORM VALIDATION

These two fields are now MANDATORY:

passengers_count

luggage_count

âŒ No booking should be saved without these.

âœ… 8ï¸âƒ£ VEHICLES API MUST RETURN CAPACITY + PRICING

Vehicles API must return:

type

plate_number

max_passengers

max_luggage

has_big_trunk

hourly_price

per_km_price

status

active

âœ… 9ï¸âƒ£ CONFIRM ADMIN UI RUNS ONLY ON PORT 8000

All UI + screenshots + API tests must use:

http://localhost:8000


âŒ Do NOT use port 5000 for backend/admin UI.

âœ… ğŸ”Ÿ DO NOT INSERT NEW DATA

The DB is ALREADY full:

116 bookings

16 vehicles

16 drivers

Only query + API + frontend mapping is wrong.
Fix mapping â€” data will appear instantly.

âœ… 11ï¸âƒ£ WHATSAPP BUSINESS API â€” FINAL CONFIRMATION REQUIRED

Please reply clearly:

âœ… WhatsApp helper functions created

âœ… Token + Phone ID placeholders created

âœ… Notification logs already working

âœ… Only API token is pending from our side

Reply only:

âœ… WhatsApp system READY
or
âŒ WhatsApp system NOT READY

âœ… 12ï¸âƒ£ AFTER COMPLETING ALL ABOVE, SEND PROOF

Please send screenshots of:

Dashboard with real numbers

Bookings table with rows

Vehicles table (showing luggage + passengers)

Drivers table

Customers table

ğŸš« STOP ALL OTHER DEVELOPMENT UNTIL THIS IS 100% FIXED

No new features.
No UI redesign.
No vendor enhancements.

ONLY priority = API â†” DB â†” UI SYNC.

âœ… FOR YOU (SIMPLE SUMMARY)

âœ” Database = Perfect
âœ” Data = Fully present
âœ” Connection = Correct
âŒ APIs = Using old fields
âŒ Frontend = Expecting old schema
âœ… Fix = Update queries to match REAL SCHEMA ONLY